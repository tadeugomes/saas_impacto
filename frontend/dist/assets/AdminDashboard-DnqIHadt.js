import{b as p,r,j as s}from"./index-BpC5fKLh.js";const u={async getDashboardUsage(){return(await p.get("/api/v1/admin/dashboard/usage")).data}};function y(){const[e,x]=r.useState(null),[m,c]=r.useState(!0),[n,h]=r.useState(null);r.useEffect(()=>{(async()=>{var l,i;try{c(!0);const t=await u.getDashboardUsage();x(t)}catch(t){const d=t,o=(i=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:i.detail;h(typeof o=="string"?o:"Erro ao carregar dashboard administrativo.")}finally{c(!1)}})()},[]);const g=a=>{if(!Number.isFinite(a))return"0 B";const l=["B","KB","MB","GB","TB"];let i=a,t=0;for(;i>=1024&&t<l.length-1;)i/=1024,t+=1;return`${i.toFixed(1)} ${l[t]}`};if(m)return s.jsx("div",{className:"card",children:"Carregando uso do tenant..."});if(n||!e)return s.jsx("div",{className:"card",children:s.jsx("p",{className:"text-red-700",children:n||"Sem dados disponíveis no momento."})});const j=e.taxa_rate_limit?`${Math.min(e.taxa_rate_limit*100,100).toFixed(1)}%`:"N/A";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Administrativo"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Uso e atividade do tenant nos últimos 30 dias."})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total de análises"}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:e.total_analises})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Análises concluídas"}),s.jsx("p",{className:"text-3xl font-bold text-green-600 mt-1",children:e.analises_sucesso})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Análises com falha"}),s.jsx("p",{className:"text-3xl font-bold text-red-600 mt-1",children:e.analises_falha})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Usuários ativos (7d)"}),s.jsx("p",{className:"text-3xl font-bold text-indigo-600 mt-1",children:e.usuarios_ativos_7d})]}),s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Usuários ativos (30d)"}),s.jsx("p",{className:"text-3xl font-bold text-indigo-600 mt-1",children:e.usuarios_ativos_30d})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"card",children:[s.jsx("h2",{className:"font-semibold text-gray-900 mb-3",children:"Indicadores mais consultados"}),e.top_indicadores.length===0?s.jsx("p",{className:"text-gray-500 text-sm",children:"Sem consultas recentes para exibir."}):s.jsx("ul",{className:"divide-y",children:e.top_indicadores.map(a=>s.jsxs("li",{className:"py-2 flex justify-between text-sm",children:[s.jsx("span",{className:"font-medium text-gray-800",children:a.codigo}),s.jsxs("span",{className:"text-gray-500",children:[a.acessos," acessos"]})]},a.codigo))})]}),s.jsxs("div",{className:"card",children:[s.jsx("h2",{className:"font-semibold text-gray-900 mb-3",children:"Consumo BigQuery"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Últimos 30 dias"}),s.jsx("p",{className:"text-3xl font-bold text-blue-700 mt-2",children:g(e.bq_bytes_last_30d)}),s.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["Utilização de rate limit (estimada): ",j]})]})]})]})}export{y as AdminDashboard};
