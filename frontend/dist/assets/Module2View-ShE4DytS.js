import{r as i,j as a}from"./index-QAfPwsmx.js";import{u as N,L as I,F,E as b,i as _}from"./indicators--VS1xAaI.js";import{E as D,C as y,B as E}from"./ExportButton-Cl7ppu3h.js";import{P as S}from"./PieChart-Cdpmp2SO.js";const c=[{code:"IND-2.01",name:"Carga Total Movimentada",unit:"Toneladas",desc:"Soma de carga embarcada e desembarcada",valueField:"tonelagem_total"},{code:"IND-2.05",name:"Carga Média por Atracação",unit:"Toneladas",desc:"Carga média por atracação",valueField:"carga_media_atracacao"},{code:"IND-2.06",name:"Produtividade de Berço",unit:"Ton/hora",desc:"Toneladas por hora de operação",valueField:"produtividade_ton_hora"},{code:"IND-2.10",name:"Tonelagem Total (Ranking)",unit:"Toneladas",desc:"Ranking por tonelagem",valueField:"tonelagem_total"},{code:"IND-2.11",name:"Concentração de Carga",unit:"Toneladas",desc:"Índice de concentração",valueField:"tonelagem_total"},{code:"IND-2.12",name:"Mix de Carga",unit:"%",desc:"Distribuição por tipo de carga",valueField:"percentual",isPieChart:!0},{code:"IND-2.13",name:"Sazonalidade",unit:"Índice",desc:"Variação mensal da carga",valueField:"indice_sazonalidade"}];function x(s,o){return s[o]||0}function h(s){var o;return s.id_instalacao||s.tipo_carga||((o=s.mes)==null?void 0:o.toString())||"N/A"}function A(){const{selectedYear:s,selectedInstallation:o}=N(),[v,f]=i.useState({}),[l,u]=i.useState(!0),[m,g]=i.useState(null);return i.useEffect(()=>{(async()=>{var t,d;u(!0),g(null);try{const r=c.map(n=>_.queryIndicator({codigo_indicador:n.code,params:{ano:s,id_instalacao:o||void 0}}).catch(()=>({data:[]}))),j=await Promise.all(r),p={};j.forEach((n,C)=>{p[c[C].code]=n}),f(p)}catch(r){g(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.detail)||"Erro ao carregar indicadores")}finally{u(!1)}})()},[s,o]),l?a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Módulo 2 - Operações de Carga"}),a.jsx(I,{})]}):a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Módulo 2 - Operações de Carga"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"7 indicadores de operações de carga"})]}),a.jsx(D,{moduleCode:"2"})]}),a.jsx(F,{}),m&&a.jsx(b,{message:m,className:"mb-6"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:c.map(e=>{const t=v[e.code],d=(t==null?void 0:t.data)&&t.data.length>0;return a.jsx(y,{title:e.name,description:e.desc,unit:e.unit,isLoading:l,children:d?e.isPieChart?a.jsx(S,{labels:t.data.slice(0,10).map(r=>h(r)),data:t.data.slice(0,10).map(r=>x(r,e.valueField)),variant:"doughnut"}):a.jsx(E,{labels:t.data.slice(0,10).map(r=>h(r)),datasets:[{label:e.unit,data:t.data.slice(0,10).map(r=>x(r,e.valueField))}],yAxisLabel:e.unit,horizontal:!0}):a.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"Dados não disponíveis"})},e.code)})})]})}export{A as Module2View};
