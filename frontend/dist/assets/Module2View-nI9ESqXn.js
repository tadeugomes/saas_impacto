import{r,j as e}from"./index-BpC5fKLh.js";import{u as T,L as N,F as _,E as C,i as S}from"./indicators-CRvX9iZO.js";import{E}from"./BarChart-BHjfVXWF.js";import{I as D}from"./IndicatorDashboardCard-rHYHmTNb.js";const s=[{code:"IND-2.01",name:"Carga Total Movimentada",unit:"Toneladas",desc:"Soma de carga embarcada e desembarcada",chartType:"bar",valueField:"tonelagem_total",labelField:"id_instalacao"},{code:"IND-2.05",name:"Carga Média por Atracação",unit:"Toneladas",desc:"Carga média por atracação",chartType:"bar",valueField:"carga_media_atracacao",labelField:"id_instalacao"},{code:"IND-2.06",name:"Produtividade de Berço",unit:"Ton/hora",desc:"Toneladas por hora de operação",chartType:"bar",valueField:"produtividade_ton_hora",labelField:"id_instalacao"},{code:"IND-2.10",name:"Tonelagem Total (Ranking)",unit:"Toneladas",desc:"Ranking por tonelagem",chartType:"bar",valueField:"tonelagem_total",labelField:"id_instalacao"},{code:"IND-2.11",name:"Concentração de Carga",unit:"Toneladas",desc:"Índice de concentração",chartType:"bar",valueField:"tonelagem_total",labelField:"id_instalacao"},{code:"IND-2.12",name:"Mix de Carga",unit:"%",desc:"Distribuição por tipo de carga",chartType:"pie",valueField:"percentual",labelField:"tipo_carga"},{code:"IND-2.13",name:"Sazonalidade",unit:"Índice",desc:"Variação mensal da carga",chartType:"bar",valueField:"indice_sazonalidade",labelField:"mes"}],M=t=>({codigo_indicador:t,nome:t,unidade:"",unctad:!1,data:[]});function R(){const{selectedYear:t,selectedInstallation:n}=T(),[v,j]=r.useState({}),[m,u]=r.useState(!0),[p,g]=r.useState(null),[x,y]=r.useState(""),[l,f]=r.useState("all");r.useEffect(()=>{(async()=>{var h,b;u(!0),g(null);try{const c=s.map(i=>S.queryIndicator({codigo_indicador:i.code,params:{ano:t,id_instalacao:n||void 0}}).catch(()=>M(i.code))),o=await Promise.all(c),d={};o.forEach((i,I)=>{d[s[I].code]=i}),j(d)}catch(c){const o=c,d=((b=(h=o==null?void 0:o.response)==null?void 0:h.data)==null?void 0:b.detail)||"Erro ao carregar indicadores";g(typeof d=="string"?d:"Erro ao carregar indicadores")}finally{u(!1)}})()},[t,n]);const F=r.useMemo(()=>l==="all"?s:s.filter(a=>a.code===l),[l]);return m?e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Módulo 2 - Operações de Carga"}),e.jsx(N,{})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Módulo 2 - Operações de Carga"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"7 indicadores de operações de carga"})]}),e.jsx(E,{moduleCode:"2"})]}),e.jsx(_,{}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Buscar na série"}),e.jsx("input",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-1",placeholder:"Filtrar nome no ranking",value:x,onChange:a=>y(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Indicador"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-1",value:l,onChange:a=>f(a.target.value),children:[e.jsx("option",{value:"all",children:"Todos"}),s.map(a=>e.jsx("option",{value:a.code,children:a.name},a.code))]})]})]}),p&&e.jsx(C,{message:p,className:"mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:F.map(a=>e.jsx(D,{title:a.name,description:a.desc,unit:a.unit,isLoading:m,data:v[a.code],chartType:a.chartType,valueField:a.valueField,labelField:a.labelField,filterText:x,indicatorCode:a.code},a.code))})]})}export{R as Module2View};
