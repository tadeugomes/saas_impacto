import{c as U,j as e,r as d,b as K}from"./index-BpC5fKLh.js";import{u as Ls,i as te,F as Ms,E as me,C as ge,L as ss}from"./indicators-CRvX9iZO.js";import{a as N,e as Ps,E as Rs,B as as,h as ts,C as Os,g as Ds}from"./BarChart-BHjfVXWF.js";import{L as Ts}from"./LineChart-COZsv4d-.js";import{n as Fs,i as os,a as Bs,t as ye,f as rs,r as Us}from"./municipioLabels-6VdFVUhQ.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=U("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=U("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=U("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=U("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=U("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=U("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=U("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=U("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=U("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=U("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=U("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=U("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ks={queued:{label:"Na fila",icon:zs,className:"bg-amber-50 text-amber-700 border-amber-200"},running:{label:"Em execu√ß√£o",icon:Gs,className:"bg-blue-50 text-blue-700 border-blue-200 animate-pulse"},success:{label:"Conclu√≠da",icon:Vs,className:"bg-emerald-50 text-emerald-700 border-emerald-200"},failed:{label:"Falhou",icon:Ws,className:"bg-red-50 text-red-700 border-red-200"}};function ds({status:s}){const a=Ks[s],o=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full border text-xs font-medium ${a.className}`,children:[e.jsx(o,{className:"h-3.5 w-3.5"}),a.label]})}function xe(s){return typeof s=="number"&&Number.isFinite(s)?s:null}function ea(s){return s.status==="success"?"An√°lise conclu√≠da com sucesso":s.status==="failed"?"Falha na execu√ß√£o":s.status==="running"?"Executando an√°lise":"Aguardando processamento"}function sa({detail:s}){var p;const a=s.result_summary||{},o=xe(a.p_value),r=xe(a.coef),i=xe(a.n_obs),g=o!==null?o<.05:null,h=d.useMemo(()=>{const b=a.outcomes;return Array.isArray(b)?b.filter(_=>typeof _=="string"):[]},[a.outcomes]),f=typeof a.outcome=="string"&&a.outcome.length>0?a.outcome:h[0]??"‚Äî",x=s.started_at?new Date(s.started_at).toLocaleString("pt-BR"):"‚Äî",v=s.completed_at?new Date(s.completed_at).toLocaleString("pt-BR"):"‚Äî";return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Resultado da an√°lise"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ea(s)," ‚Ä¢ M√©todo: ",e.jsx("strong",{children:s.method})]})]}),e.jsx(ds,{status:s.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4 text-sm",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Outcome"}),e.jsx("p",{className:"mt-1 font-semibold text-gray-900",children:f})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Coeficiente"}),e.jsx("p",{className:"mt-1 font-semibold text-gray-900",children:r===null?"‚Äî":N(r,4)})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Signific√¢ncia (5%)"}),e.jsx("p",{className:"mt-1 font-semibold text-gray-900",children:g===null?"‚Äî":g?"Significativo":"N√£o significativo"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"N¬∫ observa√ß√µes"}),e.jsx("p",{className:"mt-1 font-semibold text-gray-900",children:i??"‚Äî"})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-100 bg-gray-50 p-3 space-y-1 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Zs,{className:"h-4 w-4 text-gray-400"}),"P-value"]}),e.jsx("span",{className:"font-semibold",children:o===null?"‚Äî":o<1e-4?"< 0,0001":Ps(o*100)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ys,{className:"h-4 w-4 text-gray-400"}),"Dura√ß√£o"]}),e.jsx("span",{children:s.duration_seconds===void 0||s.duration_seconds===null?"‚Äî":`${s.duration_seconds.toFixed(1)}s`})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(qs,{className:"h-4 w-4 text-gray-400"}),"In√≠cio"]}),e.jsx("span",{children:x})]})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 mt-4 text-xs text-gray-500",children:e.jsxs("span",{children:["T√©rmino: ",v]})}),s.error_message&&e.jsx("div",{className:"mt-4 p-3 rounded-lg border border-red-200 bg-red-50 text-red-700 text-sm",children:s.error_message}),Object.keys(s.request_params).length>0&&e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-gray-600",children:"Par√¢metros da an√°lise"}),e.jsx("pre",{className:"mt-2 max-h-64 overflow-auto text-xs bg-gray-50 p-3 border border-gray-100 rounded-lg",children:JSON.stringify(s.request_params,null,2)})]}),((p=s.result_summary)==null?void 0:p.warnings)&&s.result_summary.warnings.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-amber-700 mb-1",children:"Avisos"}),e.jsx("ul",{className:"list-disc pl-5 text-sm text-amber-700",children:s.result_summary.warnings.map((b,_)=>e.jsx("li",{children:b},`${b}-${_}`))})]}),e.jsxs("button",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50",onClick:()=>{const b=new Blob([JSON.stringify(s.result_full||{},null,2)],{type:"application/json"}),_=window.URL.createObjectURL(b),j=document.createElement("a"),w=`analise_${s.id}.json`;j.href=_,j.download=w,document.body.appendChild(j),j.click(),document.body.removeChild(j),window.URL.revokeObjectURL(_)},title:"Exportar JSON bruto",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Exportar JSON"]})]})}function X(s){if(typeof s=="number"&&Number.isFinite(s))return s;if(typeof s=="string"){const a=s.trim().replace(/[^0-9eE.+\-_,]/g,"").replace(/_/g,"");if(!a)return null;const o=a.includes(","),r=a.includes(".");let i;if(o&&r){const h=a.lastIndexOf(","),f=a.lastIndexOf(".");i=h>f?a.replace(/\./g,"").replace(",","."):a.replace(/,/g,"")}else o?i=a.replace(",","."):i=a;const g=Number(i);return Number.isFinite(g)?g:null}return null}function aa(s){return s>=0?`+${s}`:String(s)}function ta(s){return s===null?null:s<.05}function oa({outcome:s,outcomeLabel:a,coefficients:o}){const r=o.map(n=>{const L=X(n.rel_time),z=X(n.coef);return L===null||z===null?null:{relTime:L,coef:z,se:X(n.se),ciLower:X(n.ci_lower),ciUpper:X(n.ci_upper),pValue:X(n.pvalue??n.p_value),significant:ta(X(n.pvalue??n.p_value)),isReference:n.period==="reference"}}).filter(n=>n!==null).sort((n,L)=>n.relTime-L.relTime);if(!r.length)return e.jsx("div",{className:"text-sm text-gray-500",children:"N√£o h√° pontos v√°lidos para Event Study."});const i=r.map(n=>`t=${aa(n.relTime)}`),g=r.map(n=>n.ciLower),h=r.map(n=>n.ciUpper),f=r.map(n=>n.significant?n.coef:null),x=r.map(n=>n.significant===!1?n.coef:null),v=r.map(()=>0),p=r.filter(n=>n.significant).length,b=r.filter(n=>n.pValue!==null?n.pValue<.1:!1).length,_=r.filter(n=>n.relTime>=0&&!n.isReference),j=_.length,w=j?_.reduce((n,L)=>n+L.coef,0)/j:null,M=r.filter(n=>n.relTime<0).length,V=r.filter(n=>n.relTime>=0).length,P=r.find(n=>n.isReference)?"incluindo refer√™ncia t=-1":"",$=[`Per√≠odos pr√©: ${M}`,`P√≥s: ${V}${P}`,`signif. (5%): ${p}/${r.length}`,`signif. (10%): ${b}/${r.length}`].join(" | "),D=j>0&&w!==null?`M√©dia p√≥s-tratamento (sem refer√™ncia): ${N(w,6)}`:"Sem per√≠odos p√≥s-tratamento dispon√≠veis na janela informada.";return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Evento: ",a||s]}),e.jsx("p",{className:"text-xs text-gray-600",children:$}),e.jsx("p",{className:"text-xs text-gray-700",children:D}),e.jsx("div",{className:"h-64",children:e.jsx(Ts,{labels:i,datasets:[{label:"Refer√™ncia (0)",data:v,borderColor:"#6b7280",backgroundColor:"#6b728022",fill:!1,borderDash:[6,4],pointRadius:0},{label:"CI superior",data:h,borderColor:"#d97706",backgroundColor:"#d9770618",borderDash:[4,4],pointRadius:0,fill:!1},{label:"CI inferior",data:g,borderColor:"#d97706",backgroundColor:"#d9770618",borderDash:[4,4],pointRadius:0,fill:!1},{label:"Coeficiente (p < 0,05)",data:f,borderColor:"#10b981",backgroundColor:"#10b98133",fill:!1,pointRadius:5},{label:"Coeficiente (p ‚â• 0,05)",data:x,borderColor:"#3b82f6",backgroundColor:"#3b82f633",fill:!1,pointRadius:3,pointStyle:"rectRot"},...r.some(n=>n.isReference)?[{label:"Per√≠odo refer√™ncia",data:r.map(n=>n.isReference?n.coef:null),borderColor:"#7c3aed",backgroundColor:"#7c3aed33",fill:!1,pointRadius:5,pointStyle:"triangle"}]:[]],yAxisLabel:"Coeficiente",yAxisFormat:"decimal6",yAxisBeginAtZero:!1,title:`Event study (${a||s})`})}),e.jsxs("details",{className:"text-sm",children:[e.jsx("summary",{className:"text-gray-600 cursor-pointer",children:"Ver pontos e IC95%"}),e.jsx("div",{className:"mt-2 max-h-44 overflow-auto text-xs",children:e.jsxs("table",{className:"min-w-full text-left",children:[e.jsx("thead",{className:"text-gray-500 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-1 pr-4",children:"Rel. time"}),e.jsx("th",{className:"py-1 pr-4",children:"Coef"}),e.jsx("th",{className:"py-1 pr-4",children:"SE"}),e.jsx("th",{className:"py-1 pr-4",children:"CI inf."}),e.jsx("th",{className:"py-1 pr-4",children:"CI sup."}),e.jsx("th",{className:"py-1 pr-4",children:"Signific√¢ncia (10%)"}),e.jsx("th",{className:"py-1 pr-4",children:"P-valor"})]})}),e.jsx("tbody",{children:r.map(n=>e.jsxs("tr",{className:"border-b border-gray-50",children:[e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.relTime}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:N(n.coef,6)}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.se===null?"‚Äî":N(n.se,6)}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.ciLower===null?"‚Äî":N(n.ciLower,6)}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.ciUpper===null?"‚Äî":N(n.ciUpper,6)}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.significant===null?"‚Äî":n.significant?"Sim":"N√£o"}),e.jsx("td",{className:"py-1 pr-4 font-mono",children:n.pValue===null?"‚Äî":N(n.pValue,6)})]},`${n.relTime}-${n.coef}`))})]})})]})]})}function oe(s){return s==null||Number.isNaN(s)?"‚Äî":typeof s=="number"?s.toFixed(4):String(s)}function ra({items:s}){return s.length?e.jsx("div",{className:"space-y-4",children:s.map(a=>{const o=a.comparison_table||[];return e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-800 mb-3",children:["Compara√ß√£o de m√©todos: ",a.outcome]}),o.length>0?e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-gray-500 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 pr-3",children:"M√©todo"}),e.jsx("th",{className:"py-2 pr-3",children:"Estimate"}),e.jsx("th",{className:"py-2 pr-3",children:"SE"}),e.jsx("th",{className:"py-2 pr-3",children:"CI_inf"}),e.jsx("th",{className:"py-2 pr-3",children:"CI_sup"}),e.jsx("th",{className:"py-2 pr-3",children:"P-Value"}),e.jsx("th",{className:"py-2 pr-3",children:"Signif."}),e.jsx("th",{className:"py-2 pr-3",children:"Notas"})]})}),e.jsx("tbody",{children:o.map(r=>e.jsxs("tr",{className:"border-b last:border-b-0 border-gray-100",children:[e.jsx("td",{className:"py-2 pr-3 font-medium",children:r.Method}),e.jsx("td",{className:"py-2 pr-3 font-mono",children:oe(r.Estimate)}),e.jsx("td",{className:"py-2 pr-3 font-mono",children:oe(r.SE)}),e.jsx("td",{className:"py-2 pr-3 font-mono",children:oe(r.CI_Lower)}),e.jsx("td",{className:"py-2 pr-3 font-mono",children:oe(r.CI_Upper)}),e.jsx("td",{className:"py-2 pr-3 font-mono",children:oe(r.P_Value)}),e.jsx("td",{className:"py-2 pr-3",children:r.Significant}),e.jsx("td",{className:"py-2 pr-3",children:r.Notes||"‚Äî"})]},`${a.outcome}-${r.Method}`))})]})}):e.jsx("p",{className:"text-sm text-gray-500",children:"Sem tabela de compara√ß√£o para este outcome."}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsxs("p",{children:["Recomenda√ß√£o: ",a.recommendation||"‚Äî"]}),e.jsxs("p",{className:"mt-1",children:["Consist√™ncia: ",a.consistency_assessment?String(a.consistency_assessment):"‚Äî"]})]})]},a.outcome)})}):null}function na(s,a){if(!s)return a;const o=/filename="([^"]+)"/.exec(s);return o&&o[1]?o[1]:a}const se={async createAnalysis(s){return(await K.post("/api/v1/impacto-economico/analises",s)).data},async listAnalyses(s){return(await K.get("/api/v1/impacto-economico/analises",{params:s})).data},async getAnalysis(s){return(await K.get(`/api/v1/impacto-economico/analises/${s}`)).data},async getAnalysisResult(s){return(await K.get(`/api/v1/impacto-economico/analises/${s}/result`)).data},async getAnalysisReport(s){const a=await K.get(`/api/v1/impacto-economico/analises/${s}/report`,{responseType:"blob"});return{blob:a.data,filename:na(a.headers["content-disposition"],`analise_${s}.docx`)}},async suggestMatchingControls(s){return(await K.post("/api/v1/impacto-economico/matching",s)).data}},ia={queued:2e3,running:5e3,success:0,failed:0};function ca(s){return s==="success"||s==="failed"}function la(s){if(s==="queued"||s==="running"||s==="success"||s==="failed")return s}function da(s){const[a,o]=d.useState(null),[r,i]=d.useState(null),[g,h]=d.useState(!1),[f,x]=d.useState(!1),[v,p]=d.useState(null),b=d.useRef(null),_=()=>{b.current!==null&&(window.clearTimeout(b.current),b.current=null)},j=d.useCallback(async P=>{const $=await se.getAnalysis(P),D=la($.status);if(!D)throw new Error(`Status inesperado: ${$.status}`);const n={...$,status:D};return o(n),n},[]),w=d.useCallback(async P=>{const $=await se.getAnalysisResult(P);return i($),$},[]),M=d.useCallback(async P=>{var $,D;try{const n=await j(P);if(ca(n.status)){x(!1);try{await w(P)}catch{i(null)}return}const L=ia[n.status];x(!0),b.current=window.setTimeout(()=>{M(P)},L)}catch(n){_(),x(!1);const L=n;p((D=($=L==null?void 0:L.response)==null?void 0:$.data)!=null&&D.detail?String(L.response.data.detail):n instanceof Error?n.message:"Erro ao consultar an√°lise.")}finally{h(!1)}},[w,j]),V=d.useCallback(()=>{s&&(_(),p(null),i(null),o(null),x(!0),h(!0),M(s))},[s,M]);return d.useEffect(()=>{if(!s){_(),x(!1),o(null),i(null),h(!1),p(null);return}return h(!0),p(null),M(s),()=>{_()}},[s,M]),{analysis:a,result:r,isLoading:g,isPolling:f,error:v,refresh:V}}const he={did:"Diferen√ßas em Diferen√ßas",iv:"Vari√°veis Instrumentais",panel_iv:"Painel com Instrumento",event_study:"Estudo de Evento",compare:"Compara√ß√£o de M√©todos",scm:"Controle Sint√©tico",augmented_scm:"Controle Sint√©tico Aumentado"},ma={did:"Compara a evolu√ß√£o dos munic√≠pios portu√°rios com munic√≠pios semelhantes antes e depois do evento",iv:"Usa a movimenta√ß√£o de carga como instrumento para isolar o efeito causal do porto",panel_iv:"Combina dados em painel com instrumento para controlar efeitos fixos de munic√≠pio e ano",event_study:"Mostra a evolu√ß√£o do impacto ano a ano, validando se n√£o havia diferen√ßa antes do evento",compare:"Roda m√∫ltiplos m√©todos e verifica se chegam √† mesma conclus√£o",scm:'Constr√≥i um "munic√≠pio fict√≠cio" para compara√ß√£o contrafactual',augmented_scm:"Controle sint√©tico com corre√ß√£o de vi√©s por regress√£o"},ua={pib_log:{label:"PIB Municipal",isLog:!0,kind:"log"},pib_per_capita_log:{label:"Renda per Capita",isLog:!0,kind:"log"},n_vinculos_log:{label:"Empregos no Setor Portu√°rio",isLog:!0,kind:"log"},empregos_totais_log:{label:"Empregos Totais do Munic√≠pio",isLog:!0,kind:"log"},toneladas_antaq_log:{label:"Movimenta√ß√£o de Carga (toneladas)",isLog:!0,kind:"log"},comercio_dolar_log:{label:"Com√©rcio Exterior",isLog:!0,kind:"log"},exportacao_dolar_log:{label:"Exporta√ß√µes",isLog:!0,kind:"log"},importacao_dolar_log:{label:"Importa√ß√µes",isLog:!0,kind:"log"},massa_salarial_total_log:{label:"Massa Salarial Total",isLog:!0,kind:"log"},massa_salarial_portuaria_log:{label:"Massa Salarial do Setor Portu√°rio",isLog:!0,kind:"log"},populacao_log:{label:"Popula√ß√£o",isLog:!0,kind:"log"},receitas_total_log:{label:"Receita Municipal",isLog:!0,kind:"log"},despesas_total_log:{label:"Despesa Municipal",isLog:!0,kind:"log"},pib:{label:"PIB Municipal",isLog:!1,kind:"level"},pib_per_capita:{label:"Renda per Capita",isLog:!1,kind:"level"},n_vinculos:{label:"Empregos no Setor Portu√°rio",isLog:!1,kind:"level"},empregos_totais:{label:"Empregos Totais",isLog:!1,kind:"level"},toneladas_antaq:{label:"Movimenta√ß√£o de Carga",isLog:!1,kind:"level"},comercio_dolar:{label:"Com√©rcio Exterior",isLog:!1,kind:"level"},exportacao_dolar:{label:"Exporta√ß√µes",isLog:!1,kind:"level"},importacao_dolar:{label:"Importa√ß√µes",isLog:!1,kind:"level"},crescimento_pib_percentual:{label:"Crescimento do PIB",isLog:!1,kind:"difference"},crescimento_tonelagem_pct:{label:"Crescimento da Movimenta√ß√£o",isLog:!1,kind:"difference"},crescimento_empregos_pct:{label:"Crescimento de Empregos",isLog:!1,kind:"difference"},crescimento_comercio_pct:{label:"Crescimento do Com√©rcio Exterior",isLog:!1,kind:"difference"},correlacao_tonelagem_pib:{label:"Associa√ß√£o Carga √ó PIB",isLog:!1,kind:"correlation"},correlacao_tonelagem_empregos:{label:"Associa√ß√£o Carga √ó Empregos",isLog:!1,kind:"correlation"},correlacao_comercio_pib:{label:"Associa√ß√£o Com√©rcio √ó PIB",isLog:!1,kind:"correlation"},elasticidade_tonelagem_pib:{label:"Sensibilidade Carga/PIB",isLog:!1,kind:"elasticity"},participacao_pib_regional_pct:{label:"Participa√ß√£o no PIB Regional",isLog:!1,kind:"share"},crescimento_relativo_uf_pp:{label:"Crescimento Relativo ao Estado",isLog:!1,kind:"difference"},razao_emprego_total_portuario:{label:"Propor√ß√£o Emprego Total/Portu√°rio",isLog:!1,kind:"ratio"},indice_concentracao_portuaria:{label:"Concentra√ß√£o da Atividade Portu√°ria",isLog:!1,kind:"index"}};function pa(s){const a=s.pvalue,o=s.nObs;return a!==null&&a<.05&&(o===null||o>=30)?"strong":a!==null&&a<.1||a!==null&&a<.05&&o!==null&&o<30?"moderate":"weak"}const ga={strong:{color:"text-emerald-700",bg:"bg-emerald-50",border:"border-emerald-200",label:"Evid√™ncia forte",description:"Resultado estatisticamente significativo com amostra robusta"},moderate:{color:"text-amber-700",bg:"bg-amber-50",border:"border-amber-200",label:"Evid√™ncia moderada",description:"Resultado com signific√¢ncia marginal ou amostra limitada"},weak:{color:"text-red-700",bg:"bg-red-50",border:"border-red-200",label:"Evid√™ncia fraca",description:"Sem signific√¢ncia estat√≠stica convencional neste recorte"}},fa=[{value:"pib_log",label:"PIB Municipal"},{value:"pib_per_capita_log",label:"Renda per Capita"},{value:"n_vinculos_log",label:"Empregos no Setor Portu√°rio"},{value:"empregos_totais_log",label:"Empregos Totais"},{value:"toneladas_antaq_log",label:"Movimenta√ß√£o de Carga"},{value:"comercio_dolar_log",label:"Com√©rcio Exterior"},{value:"exportacao_dolar_log",label:"Exporta√ß√µes"},{value:"importacao_dolar_log",label:"Importa√ß√µes"},{value:"massa_salarial_total_log",label:"Massa Salarial Total"},{value:"massa_salarial_portuaria_log",label:"Massa Salarial Portu√°ria"},{value:"populacao_log",label:"Popula√ß√£o"}],ns=s=>({codigo_indicador:s,nome:s,unidade:"",unctad:!1,data:[]});function ue(s){return s.data.filter(a=>a!==null&&typeof a=="object")}function xa(s){return Array.isArray(s)?s.filter(a=>a!==null&&typeof a=="object").map(a=>{const o=a.Method,r=a.Estimate,i=a.SE,g=a.CI_Lower,h=a.CI_Upper,f=a.P_Value,x=a.Significant,v=a.Notes;return{Method:typeof o=="string"?o:"‚Äî",Estimate:ne(r),SE:ne(i),CI_Lower:ne(g),CI_Upper:ne(h),P_Value:ne(f),Significant:typeof x=="string"?x:"‚Äî",Notes:typeof v=="string"?v:null,...a}}):[]}function ve(s){if(typeof s=="number"&&Number.isFinite(s))return s;if(typeof s=="string"){const a=s.replace(/[^0-9eE.+\-_,]/g,"").replace(/_/g,"").trim();if(!a)return null;const o=a.includes(","),r=a.includes(".");let i;if(o&&r){const h=a.lastIndexOf(","),f=a.lastIndexOf(".");i=h>f?a.replace(/\./g,"").replace(",","."):a.replace(/,/g,"")}else o?i=a.replace(",","."):i=a;const g=Number(i);return Number.isFinite(g)?g:null}return null}function O(s){const a=ve(s);return a!==null&&Number.isFinite(a)?a:null}function ha(s,a,o=10){return s.map(r=>{const i=ja(r,a);return Number.isFinite(i)?{row:r,value:i}:null}).filter(r=>r!==null).sort((r,i)=>Math.abs(i.value)-Math.abs(r.value)).slice(0,o)}function ms(s){return Array.isArray(s)?s.map(a=>{if(!a||typeof a!="object")return null;const o=a,r=O(o.rel_time),i=O(o.coef);return r===null||i===null?null:{rel_time:r,coef:i,se:O(o.se),ci_lower:O(o.ci_lower),ci_upper:O(o.ci_upper),pvalue:O(o.pvalue)}}).filter(a=>a!==null).sort((a,o)=>a.rel_time-o.rel_time):[]}function ba(s){if(!s.length)return null;const a=s.find(o=>o.rel_time===0);return a||(s.find(o=>o.rel_time>0)??s[0])}function us(s){if(!(s!=null&&s.result_full)||s.status!=="success")return[];const a=s.result_full;if(s.method==="compare")return[];const o=[];for(const[r,i]of Object.entries(a)){if(!i||typeof i!="object")continue;if(s.method==="event_study"){const b=ba(ms(i.coefficients));if(!b)continue;const _=b.pvalue;o.push({outcome:r,method:s.method,coef:b.coef,se:b.se,pvalue:_,ciLower:b.ci_lower,ciUpper:b.ci_upper,nObs:O(i.n_obs),significant:_!==null&&_<.05});continue}const g=i,h=g.main_result??g;if(!h||typeof h!="object")continue;const f=h,x=f.coef??f.att,v=O(x);if(v===null)continue;const p=O(f.p_value??f.pvalue);o.push({outcome:r,method:s.method,coef:v,se:O(f.std_err??f.se),pvalue:p,ciLower:O(f.ci_lower),ciUpper:O(f.ci_upper),nObs:O(f.n_obs),significant:p!==null&&p<.05})}return o}function ya(s){var r;if(!(s!=null&&s.result_full))return[];const a=s.result_full;if(s.method!=="event_study"&&s.method!=="did")return[];const o=[];for(const[i,g]of Object.entries(a)){if(!g||typeof g!="object")continue;const h=g,f=s.method==="event_study"?h.coefficients:(r=h.event_study)==null?void 0:r.coefficients;if(!Array.isArray(f))continue;const x=ms(f);x.length!==0&&o.push({outcome:i,coefficients:x})}return o}const va=[{value:"did",label:"DiD (Difference-in-Differences)"},{value:"iv",label:"IV (Vari√°veis Instrumentais)"},{value:"panel_iv",label:"Panel IV"},{value:"event_study",label:"Event Study"},{value:"compare",label:"Comparar m√©todos"}],pe=[{code:"IND-5.01",name:"PIB Municipal",unit:"R$",desc:"Valor total da economia do munic√≠pio",valueField:"pib_municipal",interpretation:"Quanto maior, maior √© a escala econ√¥mica local. Compare com o ano anterior e munic√≠pios similares.",group:"economia"},{code:"IND-5.02",name:"Renda per Capita",unit:"R$/hab",desc:"PIB dividido pela popula√ß√£o",valueField:"pib_per_capita",interpretation:"Melhor proxy de renda m√©dia. Crescimento indica melhora no bem-estar econ√¥mico.",group:"economia"},{code:"IND-5.03",name:"Popula√ß√£o",unit:"Hab",desc:"Popula√ß√£o residente estimada",valueField:"populacao",interpretation:"Base de contexto para indicadores per capita e de mercado de trabalho.",group:"economia"},{code:"IND-5.04",name:"Participa√ß√£o de Servi√ßos no PIB",unit:"%",desc:"Quanto o setor de servi√ßos representa na economia",valueField:"pib_servicos_percentual",interpretation:"Mudan√ßas indicam reestrutura√ß√£o produtiva. Munic√≠pios portu√°rios tendem a ter servi√ßos log√≠sticos relevantes.",group:"economia"},{code:"IND-5.05",name:"Participa√ß√£o da Ind√∫stria no PIB",unit:"%",desc:"Quanto a ind√∫stria representa na economia",valueField:"pib_industria_percentual",interpretation:"Alta participa√ß√£o industrial pode amplificar o impacto portu√°rio via cadeias de suprimento.",group:"economia"},{code:"IND-5.06",name:"Volume de Carga por R$ do PIB",unit:"ton/R$",desc:"Quanto o porto movimenta por unidade de PIB gerado",valueField:"intensidade_portuaria",interpretation:"Alto valor = maior depend√™ncia da atividade log√≠stica para gerar riqueza local.",group:"porto"},{code:"IND-5.07",name:"Com√©rcio Exterior por R$ do PIB",unit:"US$/R$",desc:"Abertura comercial relativa ao tamanho da economia",valueField:"intensidade_comercial",interpretation:"Mede exposi√ß√£o ao com√©rcio internacional. Mais alto = economia mais aberta e sens√≠vel a c√¢mbio e pre√ßos externos.",group:"comercio"},{code:"IND-5.08",name:"Empregos Portu√°rios no Total",unit:"%",desc:"Parcela do mercado de trabalho ligada ao porto",valueField:"concentracao_emprego_pct",interpretation:"Quanto maior, maior a depend√™ncia do ciclo portu√°rio para gera√ß√£o de emprego local.",group:"porto"},{code:"IND-5.09",name:"Sal√°rios Portu√°rios no Total",unit:"%",desc:"Participa√ß√£o da massa salarial portu√°ria",valueField:"concentracao_salarial_pct",interpretation:"Indica sensibilidade da renda familiar local ao desempenho do setor portu√°rio.",group:"porto"},{code:"IND-5.10",name:"Crescimento do PIB",unit:"%",desc:"Varia√ß√£o anual da economia",valueField:"crescimento_pib_percentual",interpretation:"Taxa positiva significa expans√£o. Sem causalidade direta ‚Äî use a an√°lise causal para atribui√ß√£o.",group:"tendencias"},{code:"IND-5.11",name:"Crescimento da Movimenta√ß√£o",unit:"%",desc:"Varia√ß√£o anual do volume de carga ANTAQ",valueField:"crescimento_tonelagem_pct",interpretation:"Mede dinamismo f√≠sico do porto. Crescimento sustentado pode anteceder expans√£o econ√¥mica.",group:"porto"},{code:"IND-5.12",name:"Crescimento de Empregos Portu√°rios",unit:"%",desc:"Varia√ß√£o anual de v√≠nculos no setor",valueField:"crescimento_empregos_pct",interpretation:"Pode ser sazonal. Quedas abruptas sugerem risco de mercado de trabalho local.",group:"tendencias"},{code:"IND-5.13",name:"Crescimento do Com√©rcio Exterior",unit:"%",desc:"Varia√ß√£o anual de exp + imp",valueField:"crescimento_comercio_pct",interpretation:"Exporta√ß√£o e importa√ß√£o agregadas. Reflete competitividade e demanda externa.",group:"comercio"},{code:"IND-5.14",name:"Associa√ß√£o Carga √ó PIB",unit:"coef.",desc:"Correla√ß√£o entre volume de carga e crescimento do PIB",valueField:"correlacao_tonelagem_pib",interpretation:"Alta correla√ß√£o sugere liga√ß√£o, mas n√£o prova causalidade. Use a an√°lise causal para quantificar o efeito.",group:"porto"},{code:"IND-5.15",name:"Associa√ß√£o Carga √ó Empregos",unit:"coef.",desc:"Correla√ß√£o entre carga e empregos portu√°rios",valueField:"correlacao_tonelagem_empregos",interpretation:"Indica se expans√£o de carga acompanha gera√ß√£o de empregos no setor.",group:"porto"},{code:"IND-5.16",name:"Associa√ß√£o Com√©rcio √ó PIB",unit:"coef.",desc:"Correla√ß√£o entre com√©rcio exterior e PIB",valueField:"correlacao_comercio_pib",interpretation:"Mede integra√ß√£o entre abertura comercial e desempenho econ√¥mico local.",group:"comercio"},{code:"IND-5.17",name:"Sensibilidade Carga/PIB",unit:"elastic.",desc:"Resposta da tonelagem a varia√ß√µes no PIB",valueField:"elasticidade_tonelagem_pib",interpretation:"Elasticidade > 1 = movimenta√ß√£o cresce proporcionalmente mais que o PIB ‚Äî porto pr√≥-c√≠clico.",group:"porto"},{code:"IND-5.18",name:"Peso no PIB Regional",unit:"%",desc:"Participa√ß√£o no PIB da microrregi√£o",valueField:"participacao_pib_regional_pct",interpretation:"Mede concentra√ß√£o territorial. Crescimento indica ganho de relev√¢ncia regional.",group:"economia"},{code:"IND-5.19",name:"Crescimento vs. Estado",unit:"p.p.",desc:"Diferen√ßa de crescimento do munic√≠pio em rela√ß√£o ao estado",valueField:"crescimento_relativo_uf_pp",interpretation:"Valor positivo = munic√≠pio cresce mais que a m√©dia estadual. Poss√≠vel efeito porto.",group:"tendencias"},{code:"IND-5.20",name:"Propor√ß√£o Emprego Total/Portu√°rio",unit:"raz√£o",desc:"Empregos totais divididos pelos portu√°rios",valueField:"razao_emprego_total_portuario",interpretation:"Mais alto = economia mais diversificada em rela√ß√£o ao emprego portu√°rio.",group:"porto"},{code:"IND-5.21",name:"Concentra√ß√£o da Atividade Portu√°ria",unit:"0‚Äì100",desc:"√çndice composto de depend√™ncia econ√¥mica do porto",valueField:"indice_concentracao_portuaria",interpretation:"Use para compara√ß√£o relativa entre munic√≠pios e para ranking de depend√™ncia portu√°ria.",group:"porto"}];function E(s){return typeof s>"u"?"":String(s)}const R=Bs,B=Fs;function re(s){const a=new Set;for(const o of s){const r=B(o);r&&a.add(r)}return Array.from(a)}function ja(s,a){const o=[a,"valor","total"];for(const r of o){const i=s[r],g=ve(i);if(g!==null)return g}return NaN}function _a(s,a){const o=B(s.id_municipio);return o?ye(o,a):typeof s.nome_municipio=="string"&&s.nome_municipio||typeof s.id_municipio=="string"&&s.id_municipio||typeof s.id_instalacao=="string"&&s.id_instalacao||"N/A"}function ne(s){return ve(s)}function is(s){return s==null?"":`"${(typeof s=="string"?s:JSON.stringify(s)).replace(/"/g,'""')}"`}function Na(s){if(!(s!=null&&s.result_full)||typeof s.result_full!="object")return`tipo,outcome,coef,se,pvalue,n_obs,r2,rel_time,ci_lower,ci_upper
`;const a=["tipo","outcome","method","coef","se","pvalue","n_obs","r2","rel_time","ci_lower","ci_upper"],o=[];if(s.method==="compare"){const i=s.result_full.comparison,g=i&&typeof i=="object"?i:void 0;if(g)for(const h of Object.keys(g)){const f=g[h];if(!f||typeof f!="object")continue;const x=f.comparison_table;if(Array.isArray(x))for(const v of x){if(!v||typeof v!="object")continue;const p=v;o.push({tipo:"comparison",outcome:h,method:E(p.Method),coef:E(p.Estimate),se:E(p.SE),pvalue:E(p.P_Value),n_obs:"",r2:"",rel_time:"",ci_lower:E(p.CI_Lower),ci_upper:E(p.CI_Upper)})}}return`${a.join(",")}
${o.map(h=>Object.values(h).map(is).join(",")).join(`
`)}`}const r=s.result_full;for(const i of Object.keys(r)){const g=r[i];if(!g||typeof g!="object")continue;const h=g,f=h.main_result;if(f&&typeof f=="object"){const p=f;o.push({tipo:"main_result",outcome:i,method:s.method,coef:E(p.coef),se:E(p.std_err??p.se),pvalue:E(p.p_value??p.pvalue),n_obs:E(p.n_obs),r2:E(p.r2),rel_time:"",ci_lower:E(p.ci_lower),ci_upper:E(p.ci_upper)})}const x=h.coefficients,v=Array.isArray(x)?x:[];for(const p of v)if(p&&typeof p=="object"){const b=p;o.push({tipo:"coefficient",outcome:i,method:s.method,coef:E(b.coef),se:E(b.se),pvalue:E(b.pvalue),n_obs:"",r2:"",rel_time:E(b.rel_time),ci_lower:E(b.ci_lower),ci_upper:E(b.ci_upper)})}}return`${a.join(",")}
${o.map(i=>Object.values(i).map(is).join(",")).join(`
`)}`}function Ca(s){return["did","iv","panel_iv","event_study","compare","scm","augmented_scm"].includes(s)}function Sa(s,a){if(!s)return null;const o=s[a],r=O(o);return r!==null?r:null}function cs(s,a){if(!s)return[];const o=s[a];return Array.isArray(o)?o.map(r=>typeof r=="string"?r.trim():String(r??"").trim()).map(r=>B(r)).filter(r=>!!r):[]}function ls(s,a){return s.length?s.map(o=>ye(o,a)).join("; "):"n√£o informado"}function ee(s){return ua[s]||{label:s,isLog:s.endsWith("_log"),kind:s.includes("correl")?"correlation":s.includes("elastic")?"elasticity":"unknown"}}function ps(s){if(!Number.isFinite(s))return null;const a=Math.exp(s)-1;return Number.isFinite(a)?a*100:null}function be(s,a){if(a.kind==="correlation"){const o=Math.max(-1,Math.min(1,s));return{short:`${N(o,4)} (r)`,long:`Correla√ß√£o de ${N(o,4)} entre ${a.label.toLowerCase()} e a exposi√ß√£o (faixa [-1,1]).`}}if(a.kind==="elasticity")return{short:`${N(s,4)}`,long:`Elasticidade estimada de ${N(s,4)}: uma unidade de impacto do tratamento est√° associada a ${N(s,4)} varia√ß√£o relativa no n√≠vel de exposi√ß√£o/modelo.`};if(a.kind==="ratio")return{short:`${N(s,4)}`,long:`Raz√£o de ${N(s,4)} entre ${a.label.toLowerCase()} tratado e compara√ß√£o de grupo.`};if(a.kind==="index")return{short:`${N(s,4)}`,long:`N√≠vel de √≠ndice calculado em ${N(s,4)} (sem unidade absoluta).`};if(a.kind==="share"||a.kind==="difference")return{short:`${N(s,4)}%`,long:`Varia√ß√£o de ${N(s,4)} p.p. no resultado ${a.label.toLowerCase()}.`};if(a.kind==="level"||a.isLog||a.kind==="unknown"){if(a.isLog||a.kind==="log"){const o=ps(s),r=o===null?null:N(Math.abs(o),3);return{short:`${r===null?"‚Äî":`${r}%`}`,long:r===null?"N√£o foi poss√≠vel converter coeficiente log em varia√ß√£o percentual est√°vel.":`Efeito log/semilog aproximado de ${r}% no indicador ${a.label.toLowerCase()}.`}}return{short:`${N(s,4)}`,long:"Coeficiente de "+N(s,4)+` no n√≠vel de ${a.label.toLowerCase()}.`}}return{short:N(s,4),long:N(s,4)}}function Ia({outcomeLabel:s,methodLabel:a,treatedLabel:o,controlLabel:r,treatmentYear:i,installationLabel:g}){const h=i?`a partir de ${Math.trunc(i)}`:"no recorte configurado",f=o==="n√£o informado"?"munic√≠pios selecionados":`munic√≠pios ${o}`,x=r==="n√£o informado"?"controles eleg√≠veis":`com compara√ß√£o por ${r}`,v=g?` no porto ${g}`:"";return`${a} responde √† pergunta: se o choque de movimenta√ß√£o portu√°ria${v} chega aos ${f} (${h}), ${x}, qual o impacto em ${s}?`}function ka(s){return s===null?"P-valor indispon√≠vel. Use apenas como evid√™ncia explorat√≥ria.":s<.01?"Evid√™ncia forte (p < 1%)":s<.05?"Evid√™ncia compat√≠vel com 5%":s<.1?"Sinal fraco/m√©dio (10%)":"Sem evid√™ncia estat√≠stica convencional"}function wa({outcomeLabel:s,effectSummary:a,row:o,treatedLabel:r,controlLabel:i,methodLabel:g,significance:h,outcomeMeta:f,installationLabel:x}){if(f.kind==="correlation")return`${g} retornou associa√ß√£o estat√≠stica (${h}) entre ${s} e o indicador tratado. Para decis√£o de impacto, use DiD/SCM/IV com hip√≥tese forte de identifica√ß√£o.`;const v=r==="n√£o informado"?"munic√≠pios selecionados":`os munic√≠pios ${r}`,p=i&&i!=="n√£o informado"?` comparados com ${i}`:"",b=o.coef>0?"eleva":o.coef<0?"reduz":"n√£o altera claramente",_=x?` no porto ${x}`:"",j=a.short==="‚Äî"?"efeito de baixa precis√£o":`${a.long} (${a.short})`;return`Interpreta√ß√£o executiva: sob esse modelo, o cen√°rio em ${v}${p}${_} indica que o impacto estimado √© de ${j} em ${s}, em m√©dia, ou seja, tende a ${b} o indicador (${h}).`}function Ea(s,a,o){if(!(s!=null&&s.result_full)||s.status!=="success"||!s.method||s.method==="compare")return[];const r=us(s);if(!r.length)return[];const i=Ca(s.method)?s.method:"did",g=s.request_params,h=cs(g,"treated_ids"),f=cs(g,"control_ids"),x=Sa(g,"treatment_year"),v=ls(h,a),p=ls(f,a),b=he[i],_=x?`a partir de ${Math.trunc(x)}`:"no per√≠odo estudado";return r.map(j=>{const w=ee(j.outcome),M=w.label,V=f.length>0?`comparando com ${p}`:"comparando com controles eleg√≠veis",P=be(j.coef,w),$=Ia({outcomeLabel:M,methodLabel:b,treatedLabel:v,controlLabel:p,treatmentYear:x,installationLabel:o}),D=j.ciLower===null?null:N(j.ciLower,4),n=j.ciUpper===null?null:N(j.ciUpper,4),L=D===null||n===null?"":`. IC95% ${D} a ${n}`;let z=`${P.long}${L}.`;w.kind==="correlation"&&Math.abs(j.coef)>1&&(z=`${M}: valor fora do intervalo esperado de correla√ß√£o [-1, 1].`);const ae=ka(j.pvalue),G=wa({outcomeLabel:M,effectSummary:P,row:j,treatedLabel:v,controlLabel:p,methodLabel:b,significance:ae,outcomeMeta:w,installationLabel:o}),Z=j.nObs===null?"Observa√ß√µes n√£o informadas.":j.nObs<30?`Baixa robustez com ${j.nObs} observa√ß√µes.`:`Amostra com ${j.nObs} observa√ß√µes.`,ie=`${b} com munic√≠pios tratados (${v}) ${V}, aplicado ${_}. ${z} ${ae}. ${Z}`;return{outcome:j.outcome,outcomeLabel:M,question:$,method:b,interpretation:ie,implication:z,decision:G,significance:ae,confidence:Z}})}function Q(s){const a=Number(s);return Number.isFinite(a)?a:null}function Aa(s,a){return!s||!s.length?null:e.jsxs("div",{className:"mt-3 rounded border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("p",{className:"font-medium mb-1",children:"Observa√ß√µes de qualidade:"}),e.jsx("ul",{className:"list-disc pl-4 space-y-1",children:s.map((o,r)=>{const i=o,g=typeof i.tipo=="string"?i.tipo:"warn",h=typeof i.mensagem=="string"?i.mensagem:"Sem mensagem",f=typeof i.campo=="string"?i.campo:"",x=i.id_municipio?String(i.id_municipio):"",v=x?Us(x,a,{showCode:!1}):"",p=i.ano?String(i.ano):"",b=i.id_municipio||i.ano;return e.jsxs("li",{children:[e.jsx("span",{className:"font-semibold",children:g}),": ",h,v?` [munic√≠pio ${v}`:"",p?`, ano ${p}`:"",b?"]":""]},`${g}-${f}-${r}`)})})]})}function Ta(){const{selectedYear:s,selectedInstallation:a}=Ls(),[o,r]=d.useState({}),[i,g]=d.useState(!0),[h,f]=d.useState(null),[x,v]=d.useState({}),[p,b]=d.useState("did"),[_,j]=d.useState(""),[w,M]=d.useState(""),[V,P]=d.useState("pib_log"),[$,D]=d.useState("state"),[n,L]=d.useState(""),[z,ae]=d.useState(2010),[G,Z]=d.useState(s),[ie,gs]=d.useState(!0),[je,_e]=d.useState({}),[Ne,Ce]=d.useState([]),[Se,Ie]=d.useState({}),[ke,we]=d.useState(null),[fs,Ee]=d.useState(null),[Ae,T]=d.useState(null),[$e,Le]=d.useState(!1),[Me,xs]=d.useState([]),[$a,Pe]=d.useState(!1),[La,Re]=d.useState(null),[Oe,De]=d.useState(!1),[Te,Fe]=d.useState(!1),{analysis:hs,result:bs,error:Be,refresh:ys}=da(fs),y=bs??null,H=hs,Ue=d.useMemo(()=>{const t={};return Object.values(o).forEach(m=>{ue(m).forEach(u=>{const c=B(u.id_municipio),l=u.nome_municipio;c&&typeof l=="string"&&l.trim()&&!os(c,l)&&!B(l)&&(t[c.trim()]=l.trim())})}),t},[o]),F=d.useMemo(()=>({...je,...Ue}),[je,Ue]),qe=d.useMemo(()=>{const t=a?Se[a]:[];return Array.isArray(t)?re(t.map(m=>m.id_municipio)):[]},[Se,a]),ce=d.useMemo(()=>{const t=new Set(Object.keys(F));for(const m of Ne){const u=m.trim();B(u)&&t.add(u)}for(const m of qe)t.add(m);return re(Array.from(t))},[F,Ne,qe]),Ve=d.useCallback(async()=>{try{const t=await te.getMetadata(),m=Object.fromEntries(t.indicadores.map(u=>[u.codigo,u.implementation_status==="technical_debt"?"technical_debt":"implemented"]));v(m)}catch{const t=Object.fromEntries(pe.map(m=>[m.code,"implemented"]));v(t)}},[]),ze=d.useCallback(async()=>{var t,m;try{const u=await te.getPolicies(),c=re(u.allowed_municipios||[]),l=Object.values(u.municipio_influencia||u.area_influencia||{}).flatMap(k=>Array.isArray(k)?re(k.map(A=>B(A.id_municipio))):[]),S=await te.queryIndicator({codigo_indicador:"IND-5.01",params:{ano:s}}),C=re(ue(S).map(k=>B(k.id_municipio))),I=ue(S).reduce((k,A)=>{const Y=B(A.id_municipio),q=typeof A.nome_municipio=="string"?A.nome_municipio.trim():"";return Y&&q&&!os(Y,q)&&!B(q)&&(k[Y]=q),k},{});Ce(Array.from(new Set([...c,...l,...C]))),Object.keys(I).length>0&&_e(k=>({...I,...k})),Ie(u.municipio_influencia||u.area_influencia||{}),we(null)}catch(u){const c=u,l=((m=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:m.detail)||"";we(typeof l=="string"?l:"Erro ao carregar pol√≠ticas."),Ce([]),Ie({})}},[s]),W=d.useCallback(async()=>{var t,m;Pe(!0),Re(null);try{const u=await se.listAnalyses({page:1,page_size:10});xs(u.items)}catch(u){const c=u,l=((m=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:m.detail)||"Erro ao carregar hist√≥rico de an√°lises";Re(typeof l=="string"?l:"Erro ao carregar hist√≥rico de an√°lises")}finally{Pe(!1)}},[]),Ye=d.useCallback(async()=>{var t,m;g(!0),f(null);try{const u=pe.filter(C=>x[C.code]!=="technical_debt"),c=u.map(C=>te.queryIndicator({codigo_indicador:C.code,params:{ano:s,id_instalacao:a||void 0}}).catch(()=>ns(C.code))),l=await Promise.all(c),S=pe.reduce((C,I)=>(C[I.code]=ns(I.code),C),{});l.forEach((C,I)=>{S[u[I].code]=C}),r(S)}catch(u){const c=u,l=((m=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:m.detail)||"Erro ao carregar indicadores";f(typeof l=="string"?l:"Erro ao carregar indicadores")}finally{g(!1)}},[x,s,a]),le=d.useCallback(async t=>{const m=Array.from(new Set(t.map(c=>B(c)).filter(c=>c&&c.length>=2&&!F[c])));if(!m.length)return;const u={};try{(await te.getMunicipioLookup(m)).municipios.forEach(l=>{var I;const S=B(l.id_municipio),C=(I=l.nome_municipio)==null?void 0:I.trim();S&&C&&(u[S]=C)})}catch{}Object.keys(u).length>0&&_e(c=>({...c,...u}))},[F]),Qe=d.useMemo(()=>R(_),[_]),Ge=d.useMemo(()=>R(w),[w]),He=d.useMemo(()=>Array.from(new Set([...Qe,...Ge])),[Ge,Qe]);d.useEffect(()=>{le(He)},[He,le]),d.useEffect(()=>{le(ce)},[ce,le]),d.useEffect(()=>{Ve(),W(),ze()},[Ve,W,ze]),d.useEffect(()=>{!x||Object.keys(x).length===0||Ye()},[x,Ye]),d.useEffect(()=>{Z(s)},[s]),d.useEffect(()=>{H&&H.status==="success"&&W()},[H,W]);const vs=async t=>{var I,k;t.preventDefault(),T(null);const m=R(_);if(m.length===0){T('Informe pelo menos um id_municipio em "Munic√≠pios tratados".');return}const u=R(V).filter(A=>!!A);if(u.length===0){T("Informe pelo menos um outcome.");return}const c=Q(String(G)),l=Q(String(z)),S=Q(String(G));if(c===null||l===null||S===null){T("Informe per√≠odos num√©ricos v√°lidos.");return}if((p==="iv"||p==="panel_iv")&&!n.trim()){T("M√©todos IV exigem instrumento.");return}const C={method:p,treated_ids:m,control_ids:R(w),treatment_year:c,scope:$,outcomes:u,controls:null,instrument:n.trim()||null,ano_inicio:l,ano_fim:S,use_mart:ie};Le(!0);try{const A=await se.createAnalysis(C);Ee(A.id),await W()}catch(A){const Y=A,q=((k=(I=Y==null?void 0:Y.response)==null?void 0:I.data)==null?void 0:k.detail)||"Erro ao iniciar an√°lise.";T(typeof q=="string"?q:"Erro ao iniciar an√°lise.")}finally{Le(!1)}},js=async()=>{var l,S;const t=R(_);if(t.length===0){T("Informe ao menos um munic√≠pio tratado para sugerir controles.");return}const m=Q(String(G)),u=Q(String(z)),c=Q(String(G));if(m===null||u===null||c===null){T("Informe per√≠odos v√°lidos para executar o matching.");return}T(null),Fe(!0);try{const C={treated_ids:t,treatment_year:m,scope:$,ano_inicio:u,ano_fim:c},k=(await se.suggestMatchingControls(C)).suggested_controls.map(A=>A.id_municipio);M(k.join(", "))}catch(C){const I=C,k=((S=(l=I==null?void 0:I.response)==null?void 0:l.data)==null?void 0:S.detail)||"Erro ao sugerir controles.";T(typeof k=="string"?k:"Erro ao sugerir controles.")}finally{Fe(!1)}},Je=d.useMemo(()=>{if(!(y!=null&&y.result_full)||y.method!=="compare")return[];const t=y.result_full,m=t==null?void 0:t.comparison;return!m||typeof m!="object"?[]:Object.entries(m).map(([u,c])=>{const l=c;return{outcome:u,recommendation:typeof(l==null?void 0:l.recommended_estimate)=="string"?l.recommended_estimate:void 0,consistency_assessment:typeof(l==null?void 0:l.consistency_assessment)=="string"?l.consistency_assessment:(l==null?void 0:l.consistency_assessment)!==void 0?String(l.consistency_assessment):void 0,comparison_table:xa(l==null?void 0:l.comparison_table)}})},[y]),J=d.useMemo(()=>us(y),[y]),Xe=d.useMemo(()=>ya(y),[y]),Ze=d.useMemo(()=>Ea(y,F,a),[y,F,a]),_s=()=>{if(!y)return;const t=Na(y),m=new Blob([t],{type:"text/csv;charset=utf-8;"}),u=window.URL.createObjectURL(m),c=document.createElement("a");c.href=u,c.setAttribute("download",`analise_${y.id}_coefs.csv`),document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(u)},Ns=async()=>{var t,m;if(y){T(null),De(!0);try{const{blob:u,filename:c}=await se.getAnalysisReport(y.id),l=window.URL.createObjectURL(new Blob([u],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"})),S=document.createElement("a");S.href=l,S.setAttribute("download",c),document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(l)}catch(u){const c=u,l=((m=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:m.detail)||"Erro ao exportar relat√≥rio DOCX.";T(typeof l=="string"?l:"Erro ao exportar relat√≥rio DOCX.")}finally{De(!1)}}},Cs=o&&Object.keys(o).length>0,de=d.useMemo(()=>{const t=ce.map(m=>({id:m,label:ye(m,F)})).filter(m=>!!m.label);return t.sort((m,u)=>m.label.localeCompare(u.label,"pt-BR")),t},[ce,F]),[We,Ss]=d.useState(!1),[Ke,Is]=d.useState(!1),[ks,ws]=d.useState({economia:!0,porto:!0,comercio:!1,tendencias:!1}),Es=t=>ws(m=>({...m,[t]:!m[t]})),As={economia:"üèô Economia Municipal",porto:"‚öì Atividade Portu√°ria",comercio:"üåê Com√©rcio Exterior",tendencias:"üìà Tend√™ncias Anuais"},es=d.useMemo(()=>R(V),[V]),$s=t=>{const m=R(V),u=m.includes(t)?m.filter(c=>c!==t):[...m,t];P(u.join(", "))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Impacto Econ√¥mico do Porto"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Avalie como a atividade portu√°ria influencia a economia do munic√≠pio sob an√°lise"})]}),e.jsx(Rs,{moduleCode:"5"})]}),e.jsx(Ms,{}),e.jsxs("div",{className:"card space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Fa√ßa sua pergunta"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Como a movimenta√ß√£o portu√°ria alterou a economia do munic√≠pio selecionado?"})]}),e.jsxs("button",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-gray-300 text-sm text-gray-600 hover:bg-gray-50",onClick:()=>{W(),ys()},children:[e.jsx(Js,{className:"h-3.5 w-3.5"}),"Atualizar"]})]}),ke&&e.jsx(me,{message:`Pol√≠ticas: ${ke}`}),e.jsxs("form",{onSubmit:vs,className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Qual munic√≠pio recebe o impacto do porto?"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Selecione o(s) munic√≠pio(s) do munic√≠pio de influ√™ncia"}),e.jsxs("select",{value:R(_),multiple:!0,size:5,onChange:t=>j(Array.from(t.target.selectedOptions).map(m=>m.value).join(", ")),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[!de.length&&e.jsx("option",{disabled:!0,children:"Carregando munic√≠pios..."}),de.map(t=>e.jsx("option",{value:t.id,children:t.label},`t-${t.id}`))]}),R(_).length>0&&e.jsxs("p",{className:"text-xs text-indigo-700 font-medium",children:["‚úì ",rs(R(_),F)]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Com quais munic√≠pios comparar?"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Munic√≠pios sem porto para servir de base de compara√ß√£o"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:R(w),multiple:!0,size:5,onChange:t=>M(Array.from(t.target.selectedOptions).map(m=>m.value).join(", ")),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[!de.length&&e.jsx("option",{disabled:!0,children:"Carregando munic√≠pios..."}),de.map(t=>e.jsx("option",{value:t.id,children:t.label},`c-${t.id}`))]}),e.jsxs("button",{type:"button",onClick:()=>{js()},disabled:Te,className:"flex-shrink-0 inline-flex flex-col items-center gap-1 px-3 py-2 rounded-lg border border-indigo-300 bg-indigo-50 text-xs text-indigo-700 hover:bg-indigo-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Xs,{className:"h-4 w-4"}),Te?"Buscando...":"Sugerir automaticamente"]})]}),R(w).length>0&&e.jsx("p",{className:"text-xs text-gray-600",children:rs(R(w),F)})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"In√≠cio do hist√≥rico"}),e.jsx("input",{type:"number",value:z,onChange:t=>ae(Q(t.target.value)||2010),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Quando ocorreu o evento do porto?"}),e.jsx("input",{type:"number",value:G,onChange:t=>Z(Q(t.target.value)||s),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ano da interven√ß√£o ou mudan√ßa analisada"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Fim do per√≠odo"}),e.jsx("input",{type:"number",value:G,onChange:t=>Z(Q(t.target.value)||s),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"O que voc√™ quer medir?"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Selecione os indicadores de impacto de interesse"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:fa.map(t=>e.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer text-sm transition-colors ${es.includes(t.value)?"border-indigo-400 bg-indigo-50 text-indigo-800":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:es.includes(t.value),onChange:()=>$s(t.value),className:"h-3.5 w-3.5 accent-indigo-600"}),t.label]},t.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"M√©todo de an√°lise"}),e.jsx("div",{className:"grid gap-2 md:grid-cols-2 lg:grid-cols-3",children:va.map(t=>e.jsxs("label",{className:`flex flex-col gap-0.5 px-3 py-2.5 rounded-lg border cursor-pointer transition-colors ${p===t.value?"border-indigo-400 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"analysisMethod",value:t.value,checked:p===t.value,onChange:()=>b(t.value),className:"h-3.5 w-3.5 accent-indigo-600"}),e.jsx("span",{className:`text-sm font-medium ${p===t.value?"text-indigo-800":"text-gray-800"}`,children:he[t.value]})]}),e.jsx("p",{className:"text-xs text-gray-500 pl-5",children:ma[t.value]})]},t.value))})]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>Ss(t=>!t),className:"inline-flex items-center gap-1.5 text-xs text-gray-500 hover:text-gray-700",children:[We?e.jsx(fe,{className:"h-3.5 w-3.5"}):e.jsx(ge,{className:"h-3.5 w-3.5"}),"Configura√ß√µes avan√ßadas (instrumento, escopo, cache)"]}),We&&e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-3 p-3 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Vari√°vel instrumental"}),e.jsx("input",{value:n,onChange:t=>L(t.target.value),className:"w-full border border-gray-300 rounded px-2 py-1.5 text-xs",placeholder:"commodity_index, preco_soja..."}),e.jsx("p",{className:"text-xs text-gray-400",children:"Obrigat√≥rio para IV / Painel IV"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Escopo de controles"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded px-2 py-1.5 text-xs",value:$,onChange:t=>D(t.target.value),children:[e.jsx("option",{value:"state",children:"Mesmo estado"}),e.jsx("option",{value:"municipal",children:"Nacional"})]})]}),e.jsx("div",{className:"flex items-end pb-1",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:ie,onChange:t=>gs(t.target.checked),className:"h-3.5 w-3.5"}),"Usar dados pr√©-processados (mais r√°pido)"]})})]})]}),Ae&&e.jsx(me,{message:Ae}),e.jsxs("button",{type:"submit",disabled:$e,className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-lg bg-indigo-600 text-white font-medium hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Hs,{className:"h-4 w-4"}),$e?"Iniciando an√°lise...":"Analisar impacto"]})]}),Me.length>0&&e.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-2",children:"An√°lises anteriores"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Me.slice(0,5).map(t=>e.jsxs("button",{onClick:()=>Ee(t.id),className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-gray-200 text-xs text-gray-600 hover:border-indigo-300 hover:text-indigo-700",children:[e.jsx(ds,{status:t.status}),e.jsx("span",{children:he[t.method]??t.method}),e.jsx("span",{className:"text-gray-400",children:new Date(t.created_at).toLocaleDateString("pt-BR")})]},t.id))})]})]}),H&&e.jsxs("div",{className:"space-y-4",children:[(H.status==="queued"||H.status==="running")&&e.jsxs("div",{className:"card flex items-center gap-4 py-5",children:[e.jsx(ss,{}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:H.status==="queued"?"An√°lise aguardando processamento...":"Calculando o impacto..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Isso pode levar alguns instantes dependendo do tamanho dos dados."})]})]}),Be&&e.jsx(me,{message:Be}),H.status==="failed"&&(y==null?void 0:y.error_message)&&e.jsxs("div",{className:"card border-red-200 bg-red-50",children:[e.jsx("p",{className:"font-medium text-red-800 mb-1",children:"N√£o foi poss√≠vel completar a an√°lise"}),e.jsx("p",{className:"text-sm text-red-700",children:y.error_message}),e.jsx("p",{className:"text-xs text-red-500 mt-2",children:"Verifique os par√¢metros e tente novamente. Se o problema persistir, tente um per√≠odo mais longo ou munic√≠pios controle diferentes."})]}),(y==null?void 0:y.status)==="success"&&e.jsxs("div",{className:"space-y-4",children:[Ze.length>0&&y.method!=="compare"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Resultado da An√°lise"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Ze.map((t,m)=>{const u=J[m],c=u?pa(u):"weak",l=ga[c],S=u?be(u.coef,ee(u.outcome)).short:"‚Äî",C=u&&u.coef>0,I=u&&u.coef<0;return e.jsxs("div",{className:`rounded-xl border-2 p-5 space-y-3 ${l.border} ${l.bg}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Impacto em"}),e.jsx("p",{className:"text-base font-semibold text-gray-900 mt-0.5",children:t.outcomeLabel})]}),e.jsxs("span",{className:`text-xs font-semibold px-2.5 py-1 rounded-full border ${l.border} ${l.bg} ${l.color}`,children:[c==="strong"?"üü¢":c==="moderate"?"üü°":"üî¥"," ",l.label]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("span",{className:`text-4xl font-bold tabular-nums ${C?"text-emerald-700":I?"text-red-600":"text-gray-700"}`,children:[C?"+":"",S]})}),e.jsx("p",{className:"text-sm text-gray-700 font-medium",children:t.question}),e.jsx("p",{className:"text-sm text-gray-700",children:t.decision}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 pt-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-white border border-gray-200 text-gray-600",children:t.method}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-white border border-gray-200 text-gray-600",children:t.significance}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-white border border-gray-200 text-gray-600",children:t.confidence})]}),c==="weak"&&e.jsx("p",{className:"text-xs text-red-600 bg-red-50 border border-red-100 rounded p-2",children:"‚ö† Sem signific√¢ncia estat√≠stica neste recorte. Resultado n√£o deve ser usado para decis√£o. Tente um per√≠odo mais longo ou munic√≠pios controle mais similares."})]},`${t.outcome}-card`)})})]}),J.length>1&&y.method!=="compare"&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Comparativo de efeitos por indicador"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Verde = evid√™ncia estat√≠stica (p < 5%); Azul = sem evid√™ncia suficiente"}),e.jsx("div",{className:"h-56",children:e.jsx(as,{labels:J.map(t=>ee(t.outcome).label),datasets:[{label:"Efeito estimado",data:J.map(t=>(t.coef!==null?ps(t.coef):null)??t.coef),backgroundColor:J.map(t=>t.significant?"#10b981":"#93c5fd")}],yAxisLabel:"Efeito (%)",horizontal:!0,valueFormat:"decimal6"})})]}),Xe.length>0&&e.jsxs("div",{className:"card space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Evolu√ß√£o do efeito ao longo do tempo"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Os anos ",e.jsx("strong",{children:"antes"})," do evento devem mostrar valores pr√≥ximos de zero ‚Äî isso valida que o impacto realmente come√ßou com o porto. Os anos ",e.jsx("strong",{children:"depois"})," mostram a trajet√≥ria do efeito."]})]}),Xe.map(({outcome:t,coefficients:m})=>{const u=ee(t);return e.jsx(oa,{outcome:t,outcomeLabel:u.label,coefficients:m},`${t}-es`)})]}),y.method==="compare"&&Je.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Diferentes m√©todos chegam √† mesma conclus√£o?"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Quando m√∫ltiplos m√©todos apontam na mesma dire√ß√£o, a evid√™ncia √© mais robusta (sem√°foro üü¢)."}),e.jsx(ra,{items:Je})]}),e.jsxs("div",{className:"card border-gray-100",children:[e.jsxs("button",{type:"button",onClick:()=>Is(t=>!t),className:"w-full flex items-center justify-between text-sm text-gray-500 hover:text-gray-700",children:[e.jsx("span",{children:"Ver detalhes t√©cnicos (coeficientes, erros padr√£o, IC 95%)"}),Ke?e.jsx(fe,{className:"h-4 w-4"}):e.jsx(ge,{className:"h-4 w-4"})]}),Ke&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(sa,{detail:y}),J.length>0&&y.method!=="compare"&&e.jsxs("div",{className:"overflow-auto",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"Tabela de coeficientes"}),e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"text-gray-500 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"Indicador"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"Efeito (%)"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"Coef. bruto"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"Erro padr√£o"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"P-valor"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"IC 95%"}),e.jsx("th",{className:"py-1.5 pr-3 text-left",children:"N obs."})]})}),e.jsx("tbody",{children:J.map(t=>e.jsxs("tr",{className:"border-b border-gray-50",children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium",children:ee(t.outcome).label}),e.jsx("td",{className:"py-1.5 pr-3 font-mono",children:be(t.coef,ee(t.outcome)).short}),e.jsx("td",{className:"py-1.5 pr-3 font-mono",children:N(t.coef,6)}),e.jsx("td",{className:"py-1.5 pr-3 font-mono",children:t.se===null?"‚Äî":N(t.se,6)}),e.jsx("td",{className:"py-1.5 pr-3 font-mono",children:t.pvalue===null?"‚Äî":N(t.pvalue,4)}),e.jsxs("td",{className:"py-1.5 pr-3 font-mono text-gray-400",children:["[",t.ciLower===null?"‚Äî":N(t.ciLower,4),", ",t.ciUpper===null?"‚Äî":N(t.ciUpper,4),"]"]}),e.jsx("td",{className:"py-1.5 pr-3",children:t.nObs??"‚Äî"})]},`tech-${t.outcome}`))})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:_s,className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-gray-300 text-xs text-gray-700 hover:bg-gray-50",children:[e.jsx(ts,{className:"h-3.5 w-3.5"}),"Exportar dados (CSV)"]}),e.jsxs("button",{onClick:Ns,disabled:Oe||(y==null?void 0:y.status)!=="success",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-gray-300 text-xs text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ts,{className:"h-3.5 w-3.5"}),Oe?"Gerando...":"Relat√≥rio completo (DOCX)"]})]})]})]})]})]}),Cs&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Perfil Econ√¥mico do Munic√≠pio"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Indicadores descritivos para contextualizar o resultado da an√°lise ‚Äî n√£o mostram causalidade por si s√≥."})]}),i&&e.jsx(ss,{}),h&&e.jsx(me,{message:h}),["economia","porto","comercio","tendencias"].map(t=>{const m=pe.filter(c=>c.group===t),u=ks[t];return e.jsxs("div",{className:"card",children:[e.jsxs("button",{type:"button",onClick:()=>Es(t),className:"w-full flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:As[t]}),u?e.jsx(fe,{className:"h-4 w-4 text-gray-400"}):e.jsx(ge,{className:"h-4 w-4 text-gray-400"})]}),u&&e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-5",children:m.map(c=>{const l=o[c.code],C=(x[c.code]||"implemented")==="technical_debt",I=(l==null?void 0:l.data)&&l.data.length>0,k=(l==null?void 0:l.warnings)||[],A=ha(ue(l),c.valueField),Y=A.length>0;return e.jsxs(Os,{title:c.name,description:c.desc,unit:c.unit,isLoading:i,children:[e.jsx("p",{className:"text-xs text-gray-500 italic mb-2",children:c.interpretation}),C?e.jsx("div",{className:"h-52 flex items-center justify-center text-amber-600 text-sm",children:"Dados em prepara√ß√£o"}):Y?e.jsx(as,{labels:A.map(q=>_a(q.row,F)),datasets:[{label:c.unit,data:A.map(q=>q.value)}],yAxisLabel:c.unit,horizontal:!0,valueFormat:Ds(c.code)}):I?e.jsx("div",{className:"h-52 flex items-center justify-center text-gray-400 text-sm",children:"Sem dados num√©ricos para o filtro atual"}):e.jsx("div",{className:"h-52 flex items-center justify-center text-gray-300 text-sm",children:"Dados n√£o dispon√≠veis"}),k.length>0&&Aa(k,F)]},c.code)})})]},t)})]})]})}export{Ta as Module5View};
